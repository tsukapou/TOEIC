# 🎁 ご褒美イベントシステム - 完全ガイド

## 📋 概要

TOEIC PART5実践問題集アプリで、**特定の達成条件をクリアすると3人の秘書全員が同時登場して祝福**するご褒美イベントシステムです。

男性ユーザーのモチベーションを高める特別演出が満載！

## ✨ 主な特徴

### 🎯 5段階の達成レベル

各レベルに達成すると、3人の秘書が同時登場して祝福！

| レベル | 条件 | 称号 | 特徴 |
|--------|------|------|------|
| 🥉 **ブロンズ** | 1回完了 & 70%以上 | ブロンズマスター | 初達成を祝福 |
| 🥈 **シルバー** | 3回完了 & 75%以上 | シルバーマスター | 継続力を評価 |
| 🥇 **ゴールド** | 5回完了 & 80%以上 | ゴールドマスター | 全テスト制覇 |
| 💎 **プラチナ** | 5回完了 & 85%以上 | プラチナマスター | 高水準達成 |
| 👑 **パーフェクト** | 5回完了 & 90%以上 | パーフェクトマスター | **特別演出！** |

### 🎊 ご褒美イベント内容

#### 通常イベント（ブロンズ〜プラチナ）
- 🎉 **3人の秘書が同時登場**
- 💬 **各秘書からの個別メッセージ**
  - さくら：優しい励まし
  - レイナ：厳しくも認める評価
  - ユイ：元気な祝福
- 🎨 **紙吹雪アニメーション**
- 🏆 **称号授与**

#### 特別イベント（パーフェクト達成時）
- ✨ **特別な表情・演出の秘書画像**
- 🌟 **キラキラエフェクト＋豪華紙吹雪**
- 💕 **感動的な特別メッセージ**
- 🎊 **ピンク・ゴールドのグラデーション背景**
- 👑 **最高称号「パーフェクトマスター」**

## 🎭 3人の秘書からのメッセージ例

### 🥉 ブロンズ達成時

**🌸 さくら**
> 初めての達成、おめでとうございます！🌸
> 素晴らしいスタートです！この調子で頑張りましょう！

**💼 レイナ**
> まあ、悪くないスタートね。でもこれは始まりに過ぎないわ。もっと上を目指しなさい💼

**🎀 ユイ**
> やったね！お兄ちゃん/お姉ちゃん、すごいよ！🎀
> ユイ、もっと応援するからね！

### 👑 パーフェクト達成時（特別メッセージ）

**🌸 さくら**
> パーフェクト達成、本当におめでとうございます！🎊
> あなたの努力、継続力、そして学習への情熱…全てが実を結びました！
> 私、さくらは、あなたを誇りに思います。これからもずっと応援しています！💕

**💼 レイナ**
> ……見事だわ。完璧な達成、認めるわ💼
> ここまで到達できる者は稀よ。あなたの実力は本物ね。
> 私も…少しだけ、あなたを尊敬しているわ。これからもその高みを目指し続けなさい。

**🎀 ユイ**
> わぁぁぁ！！パーフェクトだよ！🎉✨
> お兄ちゃん/お姉ちゃん、本当に本当にすごい！！
> ユイ、もう感動で泣きそう…😭💕
> これからもずっとずっと、ユイがそばにいるからね！大好き！！

## 🔄 イベント発火タイミング

### 自動チェック
テスト終了画面表示後、自動的に達成判定を実行：

```javascript
// テスト終了 → 0.5秒後にチェック → 達成があれば1秒後にイベント表示
setTimeout(() => {
  const reward = SecretaryRewards.checkAndTriggerReward();
  if (reward) {
    setTimeout(() => {
      SecretaryRewards.showRewardEvent(reward);
    }, 1000);
  }
}, 500);
```

### 達成判定ロジック
1. 完了したテスト数を取得
2. 全テストの平均正答率を計算
3. 高レベルから順にチェック
4. 条件を満たし、かつ未達成のレベルを発見
5. ご褒美イベント発火！

## 💻 技術実装

### ファイル構成

```
├── js/secretary-rewards.js     # ご褒美システム本体（13KB）
├── css/secretary-rewards.css   # ご褒美UI スタイル（8KB）
└── js/secretary-multi.js       # 統合済み（イベントトリガー）
```

### 主要関数

#### `SecretaryRewards.checkAndTriggerReward()`

進捗をチェックして新規達成があればレベル情報を返す。

**戻り値**:
```javascript
{
  id: 'perfect',
  name: 'パーフェクト達成',
  condition: { completedTests: 5, avgScore: 90 },
  title: '👑 パーフェクトマスター',
  badge: '👑',
  color: '#ff1493',
  isSpecial: true
}
```

または `null`（新規達成なし）

#### `SecretaryRewards.showRewardEvent(level)`

ご褒美イベントを表示。

**引数**:
- `level`: 達成レベル情報オブジェクト

**動作**:
- 通常イベント：`showNormalReward(level)`
- 特別イベント：`showSpecialReward(level)`（パーフェクト時）

### データ保存

達成済みレベルはローカルストレージに保存：

```javascript
// 保存
localStorage.setItem('toeic_achieved_rewards', JSON.stringify(['bronze', 'silver']));

// 読み込み
const achieved = JSON.parse(localStorage.getItem('toeic_achieved_rewards'));
```

## 🎨 UI/UX デザイン

### 通常イベント
- **背景**: 黒い半透明オーバーレイ
- **モーダル**: 白背景、丸角、バウンスアニメーション
- **バッジ**: 大きな絵文字（回転登場）
- **秘書画像**: 円形、3人横並び、順次フェードイン
- **メッセージ**: 左から順次スライドイン
- **紙吹雪**: 50個のカラフルな紙片が落下

### 特別イベント（パーフェクト）
- **背景**: 紫〜ピンクのグラデーション
- **モーダル**: ピンクグラデーション、光る枠線
- **バッジ**: 超大きい王冠、揺れるアニメーション
- **秘書画像**: 特別な表情、跳ねるアニメーション、光るエフェクト
- **メッセージ**: ピンク背景、特別な装飾
- **紙吹雪**: 100個、豪華
- **キラキラ**: 30個の✨が浮遊

### アニメーション一覧

| 要素 | アニメーション | 効果 |
|------|---------------|------|
| オーバーレイ | フェードイン | 0.5秒 |
| モーダル | バウンスイン | 0.6秒、拡大縮小 |
| バッジ | 回転登場 | 1秒、360度回転 |
| バッジ（特別） | 揺れ続ける | 無限ループ |
| タイトル（特別） | 光る | 無限ループ |
| 秘書 | フェードイン | 順次0.2秒遅延 |
| 秘書（特別） | バウンス | 無限ループ、波状 |
| メッセージ | スライドイン | 左から、順次 |
| ボタン（特別） | パルス | 無限ループ、拡大縮小 |
| 紙吹雪 | 落下 | ランダム速度・回転 |
| キラキラ | 浮遊 | 上下移動、拡大縮小 |

## 🎯 ユーザー体験

### 通常達成時の流れ
1. テスト終了
2. 結果画面表示
3. 0.5秒後：バックグラウンドで達成チェック
4. 新規達成発見！
5. 1秒後：画面が暗くなる
6. 紙吹雪が降り始める
7. モーダルがバウンスして登場
8. 大きなバッジが回転して登場
9. 称号表示
10. 3人の秘書が順次登場
11. 各秘書からのメッセージが順次表示
12. 「ありがとう！」ボタンをクリック
13. フェードアウトして閉じる

### パーフェクト達成時の流れ
1. テスト終了（90%以上）
2. 結果画面表示
3. 0.5秒後：達成チェック
4. **パーフェクト達成！**
5. 1秒後：画面がピンクグラデーションに
6. **豪華な紙吹雪100個**
7. **キラキラ30個が浮遊開始**
8. 特別モーダルが登場
9. 超大きい👑が揺れながら登場
10. **「🎊 素晴らしい！ 🎊」**
11. 👑 パーフェクトマスター
12. 3人が特別表情で跳ねながら登場
13. **感動的な特別メッセージ**
14. 「ありがとう！みんな大好きです！💕」

## 🔧 カスタマイズ方法

### 新しいレベルを追加

`js/secretary-rewards.js` の `rewardLevels` に追加：

```javascript
rewardLevels: {
  // ... 既存レベル
  
  diamond: {
    id: 'diamond',
    name: 'ダイヤモンド達成',
    condition: {
      completedTests: 10,
      avgScore: 95
    },
    title: '💠 ダイヤモンドマスター',
    badge: '💠',
    color: '#b9f2ff',
    isSpecial: true
  }
}
```

### メッセージをカスタマイズ

`getRewardMessages()` 関数内で編集：

```javascript
bronze: {
  sakura: 'カスタムメッセージ',
  reina: 'カスタムメッセージ',
  yui: 'カスタムメッセージ'
}
```

### 達成記録をリセット

開発者コンソールで実行：

```javascript
SecretaryRewards.resetAchievements();
```

## 📊 効果と期待される成果

1. **学習意欲の向上**
   - 明確な目標（称号）でモチベーションUP
   - 達成時の祝福で達成感を最大化

2. **継続性の促進**
   - 段階的な目標で挫折を防ぐ
   - 次のレベルを目指したくなる

3. **キャラクター愛着**
   - 3人全員からの祝福で特別感
   - 特別メッセージで感情的なつながり

4. **ゲーミフィケーション**
   - 称号システムでコレクター欲求を刺激
   - ビジュアル的な報酬で満足度UP

5. **男性ユーザーの満足度**
   - 3人の美少女キャラクターからの祝福
   - 達成感＋視覚的な報酬のダブル効果

## 🚀 今後の拡張案

1. **音声演出**: 達成時に効果音・BGM
2. **SNSシェア**: 称号をSNSでシェア機能
3. **特別バッジ**: ホーム画面に獲得バッジを常時表示
4. **隠し称号**: 特定条件で解放される秘密の称号
5. **ランキング**: 他ユーザーとの達成率比較
6. **季節イベント**: クリスマス、正月など期間限定称号

## 🎮 テスト方法

### 手動テスト

1. テストを1回完了して70%以上取得
   → ブロンズ達成イベント発火

2. 開発者コンソールで達成記録をリセット
   ```javascript
   SecretaryRewards.resetAchievements();
   ```

3. テストを3回完了して平均75%以上
   → シルバー達成イベント発火

4. 以降、同様にゴールド、プラチナ、パーフェクトを確認

### デバッグ

達成状況を確認：
```javascript
console.log(Array.from(SecretaryRewards.achievedLevels));
```

進捗を確認：
```javascript
const progress = getProgress();
const tests = Object.keys(progress.tests || {}).length;
const scores = Object.values(progress.tests || {}).map(t => (t.score / t.total) * 100);
const avg = scores.reduce((a, b) => a + b, 0) / scores.length;
console.log(`${tests}回完了, 平均${avg.toFixed(1)}%`);
```

---

**最終更新**: 2025-12-07  
**バージョン**: 1.0.0  
**作成者**: TOEIC PART5実践問題集開発チーム
