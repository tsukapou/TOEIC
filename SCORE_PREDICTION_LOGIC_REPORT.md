# 📊 予測スコアロジック調査レポート

**調査日**: 2025-12-08  
**対象**: 予測スコア計算ロジック  
**ステータス**: ✅ **調査完了**

---

## 🔍 **概要**

アプリ内で**3種類の予測スコア計算ロジック**が存在していることが判明しました。

---

## 📊 **スコア予測ロジック一覧**

### **1️⃣ メインロジック (app.js)**

**場所**: `js/app.js` 846-909行目  
**関数**: `predictTOEICScore(correctCount, totalQuestions)`  
**用途**: テスト結果画面での予測スコア表示

#### **計算方法**:

```javascript
正答率 = 正解数 / 総問題数(30問)

// PART5スコア算出（正答率ベース）
95%以上 → PART5: 180点
90-95% → PART5: 170点
85-90% → PART5: 160点
80-85% → PART5: 150点
75-80% → PART5: 140点
70-75% → PART5: 130点
65-70% → PART5: 120点
60-65% → PART5: 110点
55-60% → PART5: 100点
50-55% → PART5: 90点
40-50% → PART5: 75点
40%未満 → PART5: 正答率 × 180点

// リーディングスコア推定
リーディングスコア = PART5スコア × 2.75

// 総合スコア範囲推定
最低総合スコア = リーディングスコア × 0.75
最高総合スコア = リーディングスコア × 1.25 (上限990点)
```

#### **例**:
| 正答数 | 正答率 | PART5 | リーディング | 総合(最低-最高) |
|--------|--------|-------|-------------|----------------|
| 30問 | 100% | 180点 | 495点 | 371-619点 |
| 29問 | 97% | 180点 | 495点 | 371-619点 |
| 27問 | 90% | 170点 | 468点 | 351-585点 |
| 24問 | 80% | 150点 | 413点 | 310-516点 |
| 21問 | 70% | 130点 | 358点 | 269-448点 |
| 18問 | 60% | 110点 | 303点 | 227-379点 |
| 15問 | 50% | 90点 | 248点 | 186-310点 |

---

### **2️⃣ パーソナライズドナビゲーション (personalized-learning-nav.js)**

**場所**: `js/personalized-learning-nav.js` 285-295行目  
**関数**: `estimateCurrentScore()`  
**用途**: ダッシュボードでの現在スコア表示

#### **計算方法**:

```javascript
// 最近5回のテスト結果から平均正答率を算出
平均正答率 = (最近5回の正解数合計) / (最近5回の総問題数)

// 簡易的な換算式
予測スコア = 400 + (平均正答率 × 400)
```

#### **例**:
| 平均正答率 | 予測スコア |
|-----------|-----------|
| 100% | 800点 |
| 90% | 760点 |
| 80% | 720点 |
| 70% | 680点 |
| 60% | 640点 |
| 50% | 600点 |
| 40% | 560点 |
| 30% | 520点 |
| 0% | 400点 |

#### **特徴**:
- ✅ **シンプル**: 線形計算で分かりやすい
- ✅ **最近の成績重視**: 直近5回の平均
- ⚠️ **スコア範囲が狭い**: 400-800点の範囲

---

### **3️⃣ 秘書モチベーションシステム (secretary-motivation.js)**

**場所**: `js/secretary-motivation.js` 737-750行目  
**関数**: `calculatePredictedScore(correctRate)`  
**用途**: 秘書からのメッセージ生成時

#### **計算方法**:

```javascript
// 正答率(%)から直接スコアを算出
95%以上 → 950点
90-95% → 900点
85-90% → 850点
80-85% → 800点
75-80% → 750点
70-75% → 700点
65-70% → 650点
60-65% → 600点
55-60% → 550点
55%未満 → 500点
```

#### **例**:
| 正答率 | 予測スコア |
|--------|-----------|
| 95% | 950点 |
| 90% | 900点 |
| 85% | 850点 |
| 80% | 800点 |
| 75% | 750点 |
| 70% | 700点 |
| 65% | 650点 |
| 60% | 600点 |
| 55% | 550点 |
| 50% | 500点 |

#### **特徴**:
- ✅ **分かりやすい**: 正答率とスコアがほぼ対応
- ✅ **モチベーション向上**: 高めのスコア設定
- ⚠️ **下限が高い**: 最低500点

---

## 📊 **3つのロジック比較**

### **同じ正答率80%の場合**:

| ロジック | 予測スコア | 特徴 |
|---------|-----------|------|
| **app.js** | 310-516点 (リーディング413点) | 最も詳細・範囲表示 |
| **personalized-learning-nav.js** | 720点 | シンプル・高め |
| **secretary-motivation.js** | 800点 | 最も高い・モチベーション重視 |

### **正答率90%の場合**:

| ロジック | 予測スコア | 特徴 |
|---------|-----------|------|
| **app.js** | 351-585点 (リーディング468点) | 詳細 |
| **personalized-learning-nav.js** | 760点 | 中程度 |
| **secretary-motivation.js** | 900点 | 最高 |

---

## ⚠️ **問題点**

### **1. ロジックの不統一**
- 3つの異なる計算方法が混在
- 同じ正答率でも予測スコアが大きく異なる
- ユーザーが混乱する可能性

### **2. スコア範囲の不一致**
- app.js: 低め～現実的 (TOEIC公式に近い)
- personalized-learning-nav.js: 中程度
- secretary-motivation.js: 高め (モチベーション重視)

### **3. 計算基準の違い**
- app.js: PART5のみからリーディング全体を推定
- personalized-learning-nav.js: 簡易的な線形計算
- secretary-motivation.js: 正答率とスコアを直接対応

---

## 💡 **推奨改善案**

### **案1: 統一ロジック**
すべてのスコア予測を`app.js`のロジックに統一

**メリット**:
- ✅ 一貫性のある予測
- ✅ TOEICの実際の配点に近い
- ✅ メンテナンス性向上

**デメリット**:
- ⚠️ secretary-motivation.jsのスコアが下がる

---

### **案2: 用途別ロジック（現状維持+改善）**
用途に応じて使い分けるが、説明を追加

**実装案**:
1. **テスト結果画面** (app.js): 「PART5からの推定リーディングスコア」
2. **ダッシュボード** (personalized-learning-nav.js): 「学習進捗スコア」
3. **秘書メッセージ** (secretary-motivation.js): 「目標到達度スコア」

**メリット**:
- ✅ 各画面で最適な表示
- ✅ ユーザーのモチベーション維持

---

### **案3: 新統一ロジック**
より正確な計算式を新規作成

**計算式案**:
```javascript
// PART5正答率からTOEIC総合スコアを推定
function predictTOEICScore(correctRate) {
  // PART5は全体の約13%
  // 正答率から総合スコアを推定
  
  if (correctRate >= 0.95) return 850; // 95%以上
  if (correctRate >= 0.90) return 800; // 90-95%
  if (correctRate >= 0.85) return 750; // 85-90%
  if (correctRate >= 0.80) return 700; // 80-85%
  if (correctRate >= 0.75) return 650; // 75-80%
  if (correctRate >= 0.70) return 600; // 70-75%
  if (correctRate >= 0.65) return 550; // 65-70%
  if (correctRate >= 0.60) return 500; // 60-65%
  
  return 400 + Math.round(correctRate * 200);
}
```

---

## 📊 **使用箇所一覧**

### **app.js**:
- テスト結果画面
- スコア計算機能
- リーディングスコア推定

### **personalized-learning-nav.js**:
- ツカサさん専用ダッシュボード
- 現在スコア表示
- 目標達成日予測

### **secretary-motivation.js**:
- 秘書からのホーム画面メッセージ
- モチベーション向上メッセージ
- 学習ペース分析

### **user-profile.js**:
- プロフィール画面
- 進捗表示
- 目標との差分計算

### **growth-dashboard.js**:
- 成長ダッシュボード
- スコア推移グラフ
- 潜在的向上幅表示

---

## 🎯 **結論**

### **現在の状況**:
- ✅ 3つの異なるスコア予測ロジックが存在
- ⚠️ 統一性がなく、ユーザーが混乱する可能性
- ⚠️ 同じ正答率でも表示箇所により大きく異なる

### **推奨アクション**:
1. **短期**: 各ロジックに説明を追加（「推定値」「参考値」等）
2. **中期**: ロジックを統一または用途別に明確化
3. **長期**: より正確な予測モデルの開発

---

## 📝 **補足情報**

### **TOEICの実際の配点**:
- リスニング: 495点満点 (100問)
- リーディング: 495点満点 (100問)
  - PART5: 30問
  - PART6: 16問
  - PART7: 54問

### **PART5の重要性**:
- 全体の約13% (30/200問)
- リーディングの30% (30/100問)
- 比較的短時間で対策可能
- 基礎文法力の指標

---

**調査者**: AI Assistant  
**調査日**: 2025-12-08  
**ステータス**: ✅ **調査完了**

---

**📊 予測スコアロジックの詳細調査が完了しました!**
