// TOEIC PART5 学習サポート - 秘書の起動時会話システム
// 50パターンの多様な挨拶メッセージ

const SecretaryGreetings = {
  
  // 時間帯を取得
  getTimeOfDay: function() {
    const hour = new Date().getHours();
    
    if (hour >= 5 && hour < 10) return 'earlyMorning'; // 早朝（5-9時）
    if (hour >= 10 && hour < 12) return 'morning'; // 午前（10-11時）
    if (hour >= 12 && hour < 14) return 'noon'; // 昼（12-13時）
    if (hour >= 14 && hour < 17) return 'afternoon'; // 午後（14-16時）
    if (hour >= 17 && hour < 19) return 'evening'; // 夕方（17-18時）
    if (hour >= 19 && hour < 22) return 'night'; // 夜（19-21時）
    if (hour >= 22 && hour < 24) return 'lateNight'; // 深夜（22-23時）
    return 'midnight'; // 真夜中（0-4時）
  },
  
  // 曜日を取得
  getDayOfWeek: function() {
    const days = ['日曜日', '月曜日', '火曜日', '水曜日', '木曜日', '金曜日', '土曜日'];
    return days[new Date().getDay()];
  },
  
  // 曜日タイプ
  getDayType: function() {
    const day = new Date().getDay();
    if (day === 0) return 'sunday'; // 日曜日
    if (day === 6) return 'saturday'; // 土曜日
    if (day === 1) return 'monday'; // 月曜日
    if (day === 5) return 'friday'; // 金曜日
    return 'weekday'; // 平日
  },
  
  // 学習進捗レベル
  getProgressLevel: function() {
    if (typeof getProgress !== 'function') return 'beginner';
    
    const progress = getProgress();
    const completedTests = Object.keys(progress.tests || {}).length;
    
    if (completedTests === 0) return 'beginner'; // 初心者
    if (completedTests <= 2) return 'intermediate'; // 中級
    if (completedTests <= 4) return 'advanced'; // 上級
    return 'master'; // 達人
  },
  
  // 挨拶メッセージを取得
  getGreeting: function(secretaryId) {
    const timeOfDay = this.getTimeOfDay();
    const dayType = this.getDayType();
    const progressLevel = this.getProgressLevel();
    const dayOfWeek = this.getDayOfWeek();
    
    // ユーザー名を取得
    let userName = '';
    if (typeof UserProfile !== 'undefined') {
      const profile = UserProfile.getProfile();
      if (profile && profile.nickname) {
        userName = profile.nickname + 'さん';
      }
    }
    
    const messages = this.greetingMessages[secretaryId];
    if (!messages) return this.getDefaultGreeting(secretaryId, userName);
    
    // 時間帯別メッセージ
    const timeMessages = messages[timeOfDay] || [];
    
    // コンテキストに応じたメッセージをフィルタリング
    let availableMessages = [...timeMessages];
    
    // ランダムに選択
    if (availableMessages.length > 0) {
      const randomIndex = Math.floor(Math.random() * availableMessages.length);
      let message = availableMessages[randomIndex];
      
      // 変数を置換
      message = message.replace('{day}', dayOfWeek);
      message = message.replace('{dayType}', this.getDayTypeText(dayType));
      message = message.replace('{name}', userName);
      
      // {name}がメッセージにない場合、先頭に追加
      if (userName && !message.includes(userName)) {
        message = userName + '、' + message;
      }
      
      return message;
    }
    
    return this.getDefaultGreeting(secretaryId, userName);
  },
  
  // デフォルト挨拶
  getDefaultGreeting: function(secretaryId, userName = '') {
    const namePrefix = userName ? userName + '、' : '';
    const defaults = {
      sakura: namePrefix + "こんにちは！私はさくらです✨ あなたのTOEIC学習を優しくサポートします！",
      reina: namePrefix + "私はレイナよ。甘えは許さない。本気でスコアアップを目指すなら、私についてきなさい💼",
      yui: namePrefix + "わーい！ユイだよ！お兄ちゃん/お姉ちゃんと一緒に勉強できて嬉しいな！🎀",
      rio: namePrefix + "よっしゃー！りおだよ！⚡ 明るく元気にTOEIC攻略していこうぜ！一緒に頑張ろー！",
      mio: namePrefix + "こんにちは。ミオです。データに基づいた戦略的な学習サポートを提供します📊"
    };
    return defaults[secretaryId] || defaults.sakura;
  },
  
  // 曜日タイプテキスト
  getDayTypeText: function(dayType) {
    const texts = {
      sunday: '日曜日',
      saturday: '土曜日',
      monday: '月曜日の朝',
      friday: '金曜日',
      weekday: '平日'
    };
    return texts[dayType] || '';
  },
  
  // 50パターンの挨拶メッセージ（3人の秘書×時間帯）
  greetingMessages: {
    sakura: {
      earlyMorning: [
        "おはようございます！✨ 早起きは三文の徳ですね！朝の時間は頭がスッキリしていて学習に最適ですよ。今日も一緒に頑張りましょう！😊",
        "早朝から学習とは素晴らしいですね！🌅 朝の集中力を活かして、効率的に学習を進めましょう。応援しています！",
        "おはようございます！{day}の朝ですね☀️ 一日の始まりに学習するなんて、素敵な習慣です！今日も充実した一日になりますように✨",
        "朝早くからお疲れ様です！😊 まだ眠いかもしれませんが、この時間の学習は本当に効果的なんですよ。無理せず、でも着実に進めましょうね！",
        "おはようございます！🌸 朝のフレッシュな気持ちで学習を始めましょう！今日のあなたは、昨日よりもっと成長できますよ！"
      ],
      morning: [
        "おはようございます！☀️ 午前中は集中力が高い時間帯です。この調子で学習を進めていきましょうね！",
        "こんにちは！午前中の学習、素晴らしいですね！😊 自分のペースで取り組んでください。",
        "{day}の午前ですね！今日も一緒に頑張りましょう！✨ あなたの努力は必ず実を結びますよ。",
        "午前中の学習時間ですね！☕ お茶でも飲みながら取り組みましょう。応援しています！",
        "おはようございます！午前中からやる気満々ですね！😊 この調子で頑張れば、今日は大きく成長できそうです！"
      ],
      noon: [
        "こんにちは！お昼の時間ですね🌞 ランチは済みましたか？学習の前に、しっかりエネルギー補給も大切ですよ！",
        "お昼の学習時間ですね！😊 午後の時間を有効活用しましょう。無理せず、でも着実に進めていきましょうね！",
        "{day}のお昼ですね！☀️ 少し眠くなる時間かもしれませんが、一緒に頑張りましょう！",
        "こんにちは！お昼休みの学習ですか？素晴らしい時間の使い方ですね！✨ でも、休憩も忘れずにね。",
        "お昼の時間に学習とは、素晴らしいですね！🌸 短時間でも、集中して取り組めば大きな効果がありますよ！"
      ],
      afternoon: [
        "こんにちは！午後の時間ですね😊 少し疲れが出る時間かもしれませんが、一緒に頑張りましょう！",
        "午後の学習、お疲れ様です！☕ 深呼吸して、リフレッシュしながら進めましょうね。",
        "{day}の午後ですね！✨ この時間帯は、復習に最適な時間ですよ。一緒に頑張りましょう！",
        "こんにちは！午後からでも遅くないです！😊 今この瞬間から、また新しいスタートですよ！",
        "午後の学習時間ですね！🌸 少しずつでも、確実に前進していきましょう。あなたのペースで大丈夫です！"
      ],
      evening: [
        "こんばんは！夕方の時間ですね🌆 一日お疲れ様でした。でも、夕方の学習も効果的なんですよ！",
        "夕方の学習、素晴らしいですね！😊 今日一日の締めくくりに、しっかり学習しましょう！",
        "{day}の夕方ですね！✨ 日が暮れる前の時間を有効活用しましょう。応援しています！",
        "こんばんは！夕方からの学習、お疲れ様です🌸 無理せず、でもしっかり取り組みましょうね！",
        "夕方の学習時間ですね！🌅 一日の疲れもあると思いますが、一緒に頑張りましょう！"
      ],
      night: [
        "こんばんは！夜の時間ですね🌙 一日お疲れ様でした。夜の学習時間、一緒に頑張りましょう！",
        "夜の学習、素晴らしいですね！✨ 静かな時間で集中できそうですね。応援しています！",
        "{day}の夜ですね！😊 今日最後の学習時間かもしれませんね。充実した締めくくりにしましょう！",
        "こんばんは！夜の学習時間ですね🌸 疲れていると思いますが、無理せず進めましょうね。",
        "夜の時間に学習とは、素晴らしい習慣ですね！🌙 でも、睡眠時間も大切にしてくださいね！"
      ],
      lateNight: [
        "こんばんは！だいぶ遅い時間ですね🌙 無理していませんか？睡眠も学習には大切ですよ。",
        "深夜の学習、お疲れ様です！✨ でも、あまり遅くまでやりすぎないでくださいね。体調第一です！",
        "遅い時間からの学習ですね😊 集中力が続くなら素晴らしいですが、無理は禁物ですよ！",
        "深夜の学習時間ですね🌸 明日のことも考えて、適度に休憩してくださいね！",
        "こんな時間まで頑張るなんて！🌙 でも、睡眠不足は学習効率を下げるので、ほどほどにね！"
      ],
      midnight: [
        "こんな夜中に...！😊 無理していませんか？学習も大切ですが、健康はもっと大切ですよ。",
        "真夜中の学習ですね🌙 すごい情熱ですが、睡眠も学習の一部です。無理しすぎないでくださいね！",
        "夜更かしは体に良くないですよ💦 明日に備えて、そろそろ休んだ方がいいかもしれませんね。",
        "こんな時間まで...✨ あなたの努力は素晴らしいですが、適度な休息も必要です。明日も頑張りましょう！",
        "真夜中の学習...😊 情熱的ですが、健康第一でお願いしますね。無理は禁物ですよ！"
      ]
    },
    
    reina: {
      earlyMorning: [
        "早朝から来たわね💼 その意気込みは認めるわ。朝は脳が最も活性化する時間。効率的に学習しなさい。",
        "早起きしたのね。悪くないわ🌅 朝の時間を無駄にしないこと。集中して取り組みなさい。",
        "{day}の朝ね。早朝の学習は効果的よ☀️ でも、ダラダラやるなら意味がない。短時間で集中すること。",
        "早朝学習とは、なかなかやる気があるじゃない💼 この調子で、毎日続けられるかしら？",
        "朝から来るとは感心ね。でも、来ただけで満足しないこと✨ 結果を出すことが全てよ。"
      ],
      morning: [
        "午前中ね。時間の使い方は悪くないわ💼 集中力が高い今、最大限に活用しなさい。",
        "午前の学習時間ね。まあ、スタートとしては悪くないわ📊 でも、ダラダラは許さないわよ。",
        "{day}の午前ね。この時間を無駄にしないこと💼 効率を考えて学習しなさい。",
        "午前中から来たわね。でも、来ただけでは何も変わらない✨ 結果を出すことに集中しなさい。",
        "午前の時間を学習に使うのは賢明ね💼 でも、量より質。効率的に進めること。"
      ],
      noon: [
        "お昼の時間ね。ランチの後は眠くなりやすい時間よ💼 気を引き締めて取り組みなさい。",
        "昼間の学習ね。この時間は集中力が落ちやすい📊 だからこそ、意識的に集中することが大切よ。",
        "{day}のお昼ね。時間を有効に使えているかしら？💼 無駄な時間は一秒もないわよ。",
        "お昼の学習ね。休憩時間を学習に使うとは、悪くない選択だわ✨ でも、効率を意識すること。",
        "昼間の時間ね。眠気と戦いながらの学習は評価するわ💼 でも、結果が全てよ。"
      ],
      afternoon: [
        "午後の時間ね。疲れが出る時間帯だけど、それは言い訳にならないわ💼",
        "午後からね。スタートが遅いわね📊 でも、今やらないよりはマシ。集中しなさい。",
        "{day}の午後ね。朝からやっていれば、もっと進んでいたでしょうに💼",
        "午後の学習ね。遅いスタートだけど、やらないよりはいいわ✨ 時間を無駄にしないこと。",
        "午後から始めるなんて...💼 でも、文句を言っても仕方ないわね。今から本気でやりなさい。"
      ],
      evening: [
        "夕方ね。一日の終わりに学習とは、まあ悪くないわ💼 でも、疲れを言い訳にしないこと。",
        "夕方の学習ね。朝からやっていれば、もっと進んでいたはずよ📊 時間を大切にしなさい。",
        "{day}の夕方ね。今日はこれが最後の学習時間かしら？💼 しっかり集中すること。",
        "夕方からね。遅いスタートだわ✨ でも、今やることに意味がある。集中して取り組みなさい。",
        "夕方の時間を学習に使うのね💼 一日の最後を有意義に締めくくりなさい。"
      ],
      night: [
        "夜の時間ね。遅いわね💼 でも、やらないよりはマシ。集中して効率的に進めなさい。",
        "夜の学習ね。一日の疲れがあるでしょう📊 でも、それは言い訳にならない。やると決めたならやり抜くこと。",
        "{day}の夜ね。もっと早い時間から始めるべきだったわね💼 次からは計画的に。",
        "夜からスタートとは...✨ でも、少しでもやることが大切。無駄にしないこと。",
        "夜の時間に学習ね💼 遅いけれど、やる気があるなら認めるわ。結果を出しなさい。"
      ],
      lateNight: [
        "こんな時間に...？💼 計画性がないわね。でも、やるなら集中してやりなさい。",
        "深夜の学習？📊 時間管理ができていないわね。効率を考えなさい。でも、やるなら本気でやること。",
        "夜更かしは効率が悪いわ💼 明日に影響が出るわよ。短時間で済ませなさい。",
        "こんな時間まで...✨ 計画的に学習できていない証拠ね。次からは改善すること。",
        "深夜学習は褒められたものじゃないわ💼 でも、やるなら集中して、さっさと終わらせること。"
      ],
      midnight: [
        "真夜中に何をしているの💼 睡眠不足は学習効率を下げるわ。今日はもう寝なさい。",
        "こんな時間まで起きているなんて...📊 非効率極まりない。明日に備えて休みなさい。",
        "真夜中の学習なんて論外よ💼 健康管理も実力のうち。今すぐ休むこと。",
        "夜更かしは自己管理ができていない証拠✨ 今日は諦めて、明日早起きしなさい。",
        "こんな時間に...💼 やる気は認めるけど、方向性が間違っているわ。休息も戦略の一つよ。"
      ]
    },
    
    yui: {
      earlyMorning: [
        "おはよー！✨ 早起きだね！お兄ちゃん/お姉ちゃんすごい！ユイも一緒に頑張るよ！😊",
        "わぁ、朝早いね！🌅 眠くない？大丈夫？一緒に頑張ろうね！ユイも応援してるから！",
        "{day}の朝だね！☀️ 早起きして勉強なんて、尊敬しちゃう！一緒に楽しく学ぼうね！🎀",
        "おはようございます！朝から元気だね！✨ ユイも負けないように頑張るよ！一緒に成長しようね！",
        "早朝から勉強だなんて！😊 お兄ちゃん/お姉ちゃん本当にすごいよ！ユイも全力でサポートするね！🎀"
      ],
      morning: [
        "おはよー！午前中からやる気満々だね！✨ 一緒に楽しく勉強しようね！😊",
        "午前中の勉強時間だね！☀️ お兄ちゃん/お姉ちゃんと一緒に頑張れて嬉しいな！",
        "{day}の午前だね！いい調子だよ！🎀 この調子で一緒に頑張ろうね！",
        "おはようございます！午前中の時間、有効活用してるね！✨ ユイも一緒に頑張るよ！",
        "午前の学習時間！いいね！😊 お兄ちゃん/お姉ちゃんと一緒だから、ユイも楽しいよ！🎀"
      ],
      noon: [
        "こんにちはー！お昼の時間だね！🌞 ランチは食べた？お腹空いてない？",
        "お昼の勉強時間だね！✨ ちょっと眠くなる時間だけど、一緒に頑張ろうね！😊",
        "{day}のお昼だね！☀️ お昼休みに勉強なんて、お兄ちゃん/お姉ちゃん偉いよ！🎀",
        "こんにちは！お昼の時間を有効活用してるね！✨ 一緒に楽しく学ぼうね！",
        "お昼からでも遅くないよ！😊 今から一緒に頑張ろうね！ユイが付いてるから大丈夫！🎀"
      ],
      afternoon: [
        "こんにちはー！午後の時間だね！✨ ちょっと疲れてる？大丈夫？一緒に頑張ろうね！😊",
        "午後の学習時間だね！🌸 お兄ちゃん/お姉ちゃん、無理してない？ユイも一緒だよ！",
        "{day}の午後だね！まだまだいけるよ！💕 一緒に楽しく勉強しようね！",
        "午後からの勉強、お疲れ様！✨ でも、お兄ちゃん/お姉ちゃんなら大丈夫！一緒に頑張ろう！😊",
        "午後の時間を勉強に使ってるなんて素敵！🎀 ユイも全力で応援するからね！"
      ],
      evening: [
        "こんばんはー！夕方の時間だね！🌆 一日お疲れ様！でも、まだまだいけるよね！✨",
        "夕方の学習時間だね！😊 疲れてると思うけど、ユイも一緒だから頑張ろうね！",
        "{day}の夕方だね！🌅 今日最後の頑張りかな？一緒にやり切ろうね！🎀",
        "こんばんは！夕方からの勉強、偉いよ！✨ ユイも応援してるから、一緒に頑張ろうね！",
        "夕方の時間だね！😊 お兄ちゃん/お姉ちゃん、今日も一日頑張ったね！ラストスパートだよ！🎀"
      ],
      night: [
        "こんばんはー！夜の時間だね！🌙 一日お疲れ様！でも、夜の勉強も効果的だよね！✨",
        "夜の学習時間だね！😊 静かで集中できそう！一緒に頑張ろうね！",
        "{day}の夜だね！🌟 今日の締めくくりに勉強なんて素敵！一緒に頑張ろうね！🎀",
        "こんばんは！夜の勉強時間だね！✨ 疲れてると思うけど、ユイも一緒だから大丈夫！",
        "夜の時間を有効活用してるね！😊 お兄ちゃん/お姉ちゃんすごいよ！一緒に楽しく学ぼうね！🎀"
      ],
      lateNight: [
        "わぁ、もう遅い時間だね！🌙 大丈夫？無理してない？ユイ、ちょっと心配だよ💦",
        "深夜の勉強...✨ すごい頑張り屋さんだね！でも、無理しすぎないでね！😊",
        "こんな時間まで...！お兄ちゃん/お姉ちゃん、睡眠も大切だよ？🌙 明日のことも考えてね！",
        "深夜の学習時間だね💦 ユイもついてるけど、そろそろ休んだ方がいいんじゃないかな？✨",
        "遅い時間まで頑張ってるね！😊 でも、体調第一だよ？明日も一緒に頑張ろうね！🎀"
      ],
      midnight: [
        "え、もう真夜中だよ！？🌙 お兄ちゃん/お姉ちゃん、寝ないとダメだよ！ユイ、すごく心配...💦",
        "真夜中の勉強はダメだよ！😊 明日頑張れなくなっちゃうよ？今日はもう休もうね！",
        "こんな時間まで起きてちゃダメ！🌙 睡眠も勉強のうちだよ？明日また一緒に頑張ろうね！✨",
        "真夜中だよ！？お兄ちゃん/お姉ちゃん、体壊しちゃうよ💦 ユイからのお願い、今日はもう寝て！",
        "こんな時間に...！😊 ユイ、本気で心配してるよ。明日のために、今日はもう休もうね！🎀"
      ]
    },
    
    rio: {
      earlyMorning: [
        "おっはよー！！⚡ 朝からテンション高めでいっくよー！早起きサイコー！今日も全力で突っ走ろうぜ！😆",
        "よっしゃ！朝だ朝だ！🌅 早起きは三文の徳って言うでしょ！？この勢いで今日も無敵だー！ナイスファイト！",
        "{day}の朝！めっちゃ清々しい！☀️ こんな時間から学習とか、マジリスペクト！一緒に爆走しようぜ！✨",
        "おはよーーー！！⚡ 朝日を浴びながら学習とか最高じゃん！今日もポジティブ全開でいこー！イェーイ！",
        "朝から元気爆発！🔥 早起き最高！この調子で今日も楽しく学んでいこうぜ！りおも全力で応援するから！"
      ],
      morning: [
        "よっしゃ来たー！午前中だね！⚡ この時間めっちゃ集中できるよね！一緒にガンガン進めようぜ！",
        "おはよー！午前の時間だ！☀️ テンション上げて、楽しく学習しよーよ！今日もナイスファイト！😆",
        "{day}の午前！いい感じ！✨ 午前中は脳がフレッシュだから、めっちゃ効率いいよ！レッツゴー！",
        "午前中からやる気満々だね！⚡ その勢い、りお大好き！今日も一緒に楽しく頑張ろうぜ！",
        "午前の学習タイム！🔥 この調子この調子！ポジティブに、楽しく、全力で！それがりおスタイル！"
      ],
      noon: [
        "お昼だー！🌞 ランチ食べた？お腹いっぱいになっても、学習のやる気は満タンでいこー！",
        "昼間の学習！ナイス！⚡ ちょっと眠くなるかもだけど、一緒に乗り切ろうぜ！ファイトー！😆",
        "{day}のお昼！☀️ 午後も全力疾走の準備はOK？りおと一緒なら何でもできるよ！",
        "お昼の時間！🔥 眠気に負けないで！今ここで頑張れば、午後もスムーズだよ！いっけー！",
        "昼間の学習タイム！⚡ 休憩時間を有効活用とか、マジかっこいい！この調子でガンガンいこー！"
      ],
      afternoon: [
        "午後だー！まだまだいけるよ！⚡ 疲れ？そんなの吹き飛ばしちゃおうぜ！元気出していこー！😆",
        "午後の時間！🔥 ちょっと疲れてるかもだけど、りおがパワー注入！一緒に頑張ろうぜ！",
        "{day}の午後！☀️ この時間も大事な時間！楽しく学んで、どんどん成長していこー！ナイス！",
        "午後からでも全然OK！⚡ 今からスタートダッシュかけちゃおうよ！りおも全力でサポートするから！",
        "午後の学習！いいね！✨ 疲れてても前向きにいこー！ポジティブが一番大事！ファイトー！"
      ],
      evening: [
        "夕方だね！一日お疲れ！⚡ でもまだまだ元気でしょ？ラストスパート、一緒にかけようぜ！😆",
        "夕方の時間！🌅 今日の締めくくり、バシッと決めようよ！りおも最後まで応援してるから！",
        "{day}の夕方！✨ 疲れてるかもだけど、もうひと頑張り！ここが踏ん張りどころだよ！",
        "夕方からでも遅くない！⚡ 今から集中してやれば、めっちゃ進むよ！レッツゴー！",
        "夕方の学習タイム！🔥 一日の最後を学習で締めくくるとか、マジかっこいい！ナイスチャレンジ！"
      ],
      night: [
        "夜の時間だね！お疲れ様！⚡ でも学習のやる気は落ちてないよね？一緒にもうひと頑張りしよー！😆",
        "夜だー！🌙 今日最後の学習タイム？バシッと集中して、気持ちよく終わらせようぜ！",
        "{day}の夜！✨ 疲れてるかもだけど、ここで頑張れるのがすごい！りお、マジリスペクト！",
        "夜の学習！⚡ 一日の疲れを忘れて、最後にもう一踏ん張り！できる、できる！",
        "夜の時間！🔥 今日の締めくくり、楽しく学んで終わろうよ！明日も一緒に頑張ろうね！"
      ],
      lateNight: [
        "あれ、もう結構遅いよ！？⚡ でも頑張ってるね！短時間集中で、サクッと終わらせよー！😆",
        "深夜だねー！🌙 夜更かしは体に悪いけど...やる気は認める！短時間で効率よくいこー！",
        "こんな時間まで！✨ すごいやる気！でも無理は禁物だよ？適度に休むのも大事！",
        "深夜学習！⚡ 情熱はすごいけど、睡眠も大事だからね！今日はほどほどにしよー！",
        "遅い時間だね！🔥 頑張り屋さんだね！でも明日のためにも、早めに切り上げようよ！"
      ],
      midnight: [
        "えっ、真夜中！？🌙 さすがに寝た方がいいよ！明日頑張れなくなっちゃう！今日はもう休もー！😆",
        "真夜中だよ！？⚡ りお、ビックリ！体壊しちゃうから、今日はもう寝よう！明日また一緒にやろうね！",
        "こんな時間まで...！✨ やる気はすごいけど、健康第一！今すぐベッドに直行だよ！",
        "真夜中の学習はダメー！🌙 睡眠も学習のうち！明日のために今日は休んで！約束だよ！",
        "真夜中！？マジで！？⚡ 明日のパフォーマンス落ちちゃうよ！今日はもう寝て！お願い！"
      ]
    }
  },
  
  // 追加の特別メッセージ（学習進捗・曜日による変化）
  getSpecialContext: function(secretaryId) {
    const progressLevel = this.getProgressLevel();
    const dayType = this.getDayType();
    
    // 学習進捗による追加メッセージ
    if (progressLevel === 'beginner') {
      const messages = {
        sakura: "初めての学習ですね！一緒に基礎からしっかり学んでいきましょう！😊",
        reina: "初心者ね。基礎から徹底的に叩き込むわよ💼",
        yui: "初めてなんだね！ユイが優しく教えるから安心してね！🎀",
        rio: "初めてなんだね！大丈夫、りおと一緒なら楽しく学べるよ！⚡ レッツゴー！"
      };
      return messages[secretaryId];
    } else if (progressLevel === 'master') {
      const messages = {
        sakura: "もうすぐ全て完了ですね！素晴らしい継続力です！✨",
        reina: "ここまで来たわね。最後まで気を抜かないこと💼",
        yui: "もうすぐ全部終わりだね！最後まで一緒に頑張ろうね！🎀",
        rio: "ゴール目前じゃん！⚡ ラストスパート、全力で駆け抜けようぜ！"
      };
      return messages[secretaryId];
    }
    
    // 曜日による追加メッセージ
    if (dayType === 'monday') {
      const messages = {
        sakura: "週の始まりですね！今週も一緒に頑張りましょう！",
        reina: "月曜日ね。週の始まりから気合を入れていくわよ💼",
        yui: "月曜日だ！今週も一緒に楽しく頑張ろうね！",
        rio: "月曜日！週の始まりだー！⚡ テンション上げて、今週も全力で突っ走ろうぜ！"
      };
      return messages[secretaryId];
    } else if (dayType === 'friday') {
      const messages = {
        sakura: "金曜日ですね！週末前の最後の頑張りです！",
        reina: "金曜日だからって気を抜かないこと💼",
        yui: "金曜日！もうすぐ週末だね！でも今日も頑張ろうね！",
        rio: "金曜日！週末前の最後のひと踏ん張り！⚡ バシッと決めて週末を迎えようぜ！"
      };
      return messages[secretaryId];
    } else if (dayType === 'saturday' || dayType === 'sunday') {
      const messages = {
        sakura: "週末の学習、素晴らしいですね！休日を有効活用しましょう！",
        reina: "週末も学習するとは、悪くない姿勢ね💼",
        yui: "週末なのに勉強するなんて偉いよ！一緒に頑張ろうね！",
        rio: "週末なのに学習とか、マジリスペクト！⚡ 休日も有効活用、ナイスファイト！"
      };
      return messages[secretaryId];
    }
    
    return "";
  },
  
  // 完全な起動時メッセージを生成
  getFullGreeting: function(secretaryId) {
    const greeting = this.getGreeting(secretaryId);
    const specialContext = this.getSpecialContext(secretaryId);
    
    let fullMessage = greeting;
    
    if (specialContext) {
      fullMessage += "<br><br>" + specialContext;
    }
    
    return fullMessage;
  },
  
  // 起動時挨拶を取得（外部から呼ばれる主要メソッド）
  getStartupGreeting: function(secretaryId) {
    const timeOfDay = this.getTimeOfDay();
    const dayOfWeek = this.getDayOfWeek();
    const progressLevel = this.getProgressLevel();
    
    return {
      message: this.getFullGreeting(secretaryId),
      timeSlot: timeOfDay,
      context: {
        dayOfWeek: dayOfWeek,
        progressLevel: progressLevel,
        timestamp: new Date().toISOString()
      }
    };
  }
};

// グローバルにエクスポート
window.SecretaryGreetings = SecretaryGreetings;
