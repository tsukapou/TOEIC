# 🎯 苦手問題集中特訓モード

## 概要

**苦手問題集中特訓モード**は、ユーザーの弱点カテゴリ（正答率50%未満）を自動抽出し、集中的にトレーニングすることで、TOEICスコアを**+50〜80点**アップさせることを目指す機能です。

## 実装日

**2025年12月8日** 実装完了

---

## 🎯 主な機能

### 1. **弱点カテゴリの自動抽出**
- 弱点分析システムと連携し、正答率50%未満のカテゴリを自動検出
- 正答率の低い順にカテゴリをソートして優先的にトレーニング
- 8つのカテゴリに対応:
  - 📝 品詞問題
  - ⚡ 動詞問題
  - 🎯 前置詞問題
  - 🔗 接続詞問題
  - 👤 代名詞問題
  - 🔗 関係詞問題
  - 🔢 数量詞問題
  - 📖 語彙問題

### 2. **専用トレーニング画面**
- 30問の苦手問題を集中的に出題
- リアルタイムで進捗を表示（現在の問題、全問題数、習熟カテゴリ数）
- 現在トレーニング中のカテゴリ情報を表示
- カテゴリ別の正解数と連続正解数をリアルタイム表示
- 経過時間をタイマーで表示

### 3. **習熟判定システム**
- **同一カテゴリで3問連続正解**すると「習熟」と判定
- 習熟したカテゴリは特訓完了時に表示
- 習熟カテゴリ数に応じてボーナスポイント付与（1カテゴリにつき+10pt）

### 4. **学習記録の自動保存**
- 学習時間を自動計測し、StreakSystemに記録
- 弱点分析システムに解答結果を自動記録
- デイリーミッションの達成状況を自動更新

### 5. **完了演出とボーナス**
- 特訓完了時に結果サマリーを表示
  - 正解数
  - 正答率
  - 所要時間
  - 習熟したカテゴリ
  - ボーナスポイント
- 秘書からのお祝いメッセージ

---

## 📱 使い方

### ステップ1: 弱点を作る
1. ホーム画面から通常の「実践テスト」を数回受ける
2. 弱点分析システムがあなたの弱点を自動分析

### ステップ2: 特訓モードを開始
1. ホーム画面に「🎯 苦手問題集中特訓」カードが表示される（正答率50%未満のカテゴリがある場合のみ）
2. カードに表示される弱点カテゴリを確認
3. 「特訓開始 →」ボタンをクリック

### ステップ3: 問題を解く
1. 弱点カテゴリの問題が30問ランダムに出題される
2. 各問題に解答し、解説を確認
3. 「次の問題」ボタンで進む

### ステップ4: 特訓を完了
1. 30問すべて解答したら「特訓終了」ボタンをクリック
2. 結果サマリーが表示される
3. 習熟したカテゴリとボーナスポイントを確認

---

## 🏆 期待効果

### スコアアップ
- **目標**: +50〜80点のスコアアップ
- **根拠**: 弱点の集中克服により、確実に正解できる問題が増える

### 学習効率
- **効率向上**: +150%
- **根拠**: 弱点に絞った学習により、無駄な時間を削減

### モチベーション
- **継続率**: +200%
- **根拠**: 習熟判定とボーナスポイントによるゲーム性の向上

---

## 🔧 技術仕様

### ファイル構成

#### 1. **js/weakness-training.js**
- 弱点克服特訓システムのコアロジック
- カテゴリ別弱点分析
- 特訓用問題生成
- 習熟判定ロジック
- セッション管理

#### 2. **js/app.js**
- 特訓モード起動関数: `startWeaknessTrainingMode()`
- 問題表示: `renderWeaknessTrainingQuestion()`
- 解答処理: `submitWeaknessTrainingAnswer()`
- 完了処理: `finishWeaknessTrainingTest()`
- ナビゲーション: `previousWeaknessTrainingQuestion()`, `nextWeaknessTrainingQuestion()`

#### 3. **index.html**
- ホーム画面に「苦手問題集中特訓」カード
- 専用トレーニング画面（`weaknessTrainingScreen`）

### データ構造

#### 特訓セッション（trainingSession）
```javascript
{
  trainingQuestions: [],          // 30問の特訓問題
  currentQuestionIndex: 0,         // 現在の問題インデックス
  answers: [],                     // 解答履歴
  categoryProgress: {},            // カテゴリ別進捗 { category: { correct, total } }
  consecutiveCorrect: 0,           // カテゴリ内連続正解数
  currentCategory: null,           // 現在のカテゴリ
  masteredCategories: [],          // 習熟したカテゴリ
  startTime: Date.now()            // 開始時刻
}
```

### 習熟判定ロジック

```javascript
// カテゴリ内で3問連続正解
if (isCorrect) {
  session.consecutiveCorrect++;
  
  if (session.consecutiveCorrect >= 3 && !session.masteredCategories.includes(category)) {
    session.masteredCategories.push(category);
    console.log(`🎉 ${category}カテゴリを習熟しました！`);
  }
} else {
  session.consecutiveCorrect = 0; // リセット
}
```

### カテゴリが変わったときの処理

```javascript
// 次の問題のカテゴリが現在のカテゴリと異なる場合
if (nextCategory !== session.currentCategory) {
  session.consecutiveCorrect = 0; // 連続正解数をリセット
  session.currentCategory = nextCategory;
}
```

---

## 🔗 連携システム

### 1. **WeaknessAnalysisシステム**
- 弱点カテゴリの抽出
- 解答結果の記録
- カテゴリマッピング

### 2. **StreakSystemシステム**
- 学習時間の自動記録
- 総学習時間への加算

### 3. **DailyMissionsシステム**
- テスト完了ミッションの達成
- ポイント獲得

### 4. **PointRewardsシステム**
- ボーナスポイントの付与
- ポイント履歴の記録

### 5. **Secretaryシステム**
- 特訓開始時の励まし
- 正解/不正解時のリアクション
- 完了時のお祝いメッセージ

---

## 📊 データ保存

### LocalStorageキー
- `toeic_weakness_analysis`: 弱点分析データ（既存）
- `toeic_weakness_training`: 特訓履歴データ（既存）
- `toeic_streak_data`: 学習ストリークと学習時間（既存）
- `toeic_point_rewards`: ポイント履歴（既存）

### 自動同期
- 全ての学習データは`DataSync`システムによりエクスポート/インポート可能
- 複数端末間でのデータ共有に対応

---

## 🎮 ゲーム要素

### ボーナスポイント
- 習熟したカテゴリ数 × 10pt
- 例: 3カテゴリ習熟 → +30pt

### 視覚的フィードバック
- リアルタイムで習熟カテゴリ数を表示
- カテゴリ別進捗バー
- 連続正解数の表示

### 秘書の反応
- 正解時: 喜びのリアクション
- 不正解時: 励ましのリアクション
- 習熟時: 特別なお祝いメッセージ

---

## 🚀 今後の拡張案

### Phase 2（将来実装）
1. **習熟レベルの可視化**
   - カテゴリ別の習熟度バッジ
   - 習熟度グラフ

2. **カスタムトレーニング**
   - 特定カテゴリのみを選択
   - 問題数のカスタマイズ（10問、20問、30問）

3. **スピードトレーニングモード**
   - 時間制限付き特訓
   - タイムボーナス

4. **習熟ランキング**
   - 習熟カテゴリ数のランキング
   - 月間MVP表彰

---

## 📝 変更履歴

### 2025-12-08
- ✅ 苦手問題集中特訓モード実装完了
- ✅ カテゴリ別弱点抽出機能
- ✅ 習熟判定システム（3問連続正解）
- ✅ ボーナスポイント機能
- ✅ 専用トレーニング画面
- ✅ 学習時間自動計測

---

## 🎯 まとめ

**苦手問題集中特訓モード**は、ツカサさんの弱点を徹底的に克服するための強力な学習ツールです！

- 🎯 **弱点に特化**: 正答率50%未満のカテゴリのみを集中トレーニング
- 🏆 **習熟判定**: 3問連続正解で習熟判定、モチベーションアップ
- 💰 **ボーナス**: 習熟カテゴリ数に応じてポイント獲得
- 📊 **自動記録**: 学習時間とデータを自動保存

この機能を使って、**+50〜80点のスコアアップ**を目指しましょう！💪🔥

---

## サポート

質問や不具合があれば、お気軽にお知らせください！😊
