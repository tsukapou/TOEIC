<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ã‚°ãƒªãƒ¼ãƒ†ã‚£ãƒ³ã‚°ãƒãƒ¼ãƒ é¸æŠçµ±åˆãƒ†ã‚¹ãƒˆ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Hiragino Sans', sans-serif;
            padding: 2rem;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 1.5rem;
            padding: 2rem;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
        }
        h1 {
            color: #1f2937;
            margin-bottom: 1.5rem;
            font-size: 2rem;
        }
        .test-section {
            background: #f9fafb;
            border-radius: 0.75rem;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            border-left: 4px solid #667eea;
        }
        .test-section h2 {
            color: #667eea;
            font-size: 1.25rem;
            margin-bottom: 1rem;
        }
        .test-result {
            background: white;
            border-radius: 0.5rem;
            padding: 1rem;
            margin-bottom: 0.75rem;
            border: 1px solid #e5e7eb;
        }
        .test-result.success {
            border-left: 4px solid #10b981;
            background: #ecfdf5;
        }
        .test-result.error {
            border-left: 4px solid #ef4444;
            background: #fef2f2;
        }
        .btn {
            padding: 0.75rem 1.5rem;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 0.5rem;
            font-weight: 600;
            cursor: pointer;
            margin: 0.5rem;
            transition: all 0.2s;
        }
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.2);
        }
        .greeting-display {
            background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
            border-radius: 0.75rem;
            padding: 1.5rem;
            margin: 1rem 0;
            border-left: 4px solid #f59e0b;
        }
        .secretary-avatar {
            font-size: 3rem;
            text-align: center;
            margin-bottom: 0.5rem;
        }
        .secretary-name {
            font-size: 1.25rem;
            font-weight: 700;
            text-align: center;
            color: #1f2937;
        }
        .secretary-message {
            text-align: center;
            color: #6b7280;
            margin-top: 0.5rem;
            line-height: 1.6;
        }
        code {
            background: #f3f4f6;
            padding: 0.25rem 0.5rem;
            border-radius: 0.25rem;
            font-family: 'Courier New', monospace;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸŒ… ã‚°ãƒªãƒ¼ãƒ†ã‚£ãƒ³ã‚°ãƒãƒ¼ãƒ é¸æŠçµ±åˆãƒ†ã‚¹ãƒˆ</h1>
        
        <div class="test-section">
            <h2>ğŸ“‹ ãƒ†ã‚¹ãƒˆã‚·ãƒŠãƒªã‚ª</h2>
            <ol style="padding-left: 1.5rem; line-height: 2;">
                <li>ç§˜æ›¸ã‚·ã‚¹ãƒ†ãƒ ã®åˆæœŸåŒ–ç¢ºèª</li>
                <li>ã‚°ãƒªãƒ¼ãƒ†ã‚£ãƒ³ã‚°ãƒãƒ¼ãƒ é¸æŠã‚·ã‚¹ãƒ†ãƒ ã®åˆæœŸåŒ–ç¢ºèª</li>
                <li>ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚°ãƒªãƒ¼ãƒ†ã‚£ãƒ³ã‚°ãƒãƒ¼ãƒ (3äºº)ã®ç¢ºèª</li>
                <li>ãƒãƒ¼ãƒ é¸æŠãƒ»å‰Šé™¤ã®ãƒˆã‚°ãƒ«æ“ä½œãƒ†ã‚¹ãƒˆ</li>
                <li>æœ€å¤§3äººåˆ¶é™ã®ãƒ†ã‚¹ãƒˆ</li>
                <li>é¸æŠã•ã‚ŒãŸç§˜æ›¸ã ã‘ãŒæŒ¨æ‹¶ã™ã‚‹ã“ã¨ã‚’ç¢ºèª</li>
            </ol>
        </div>
        
        <div class="test-section">
            <h2>ğŸ§ª ãƒ†ã‚¹ãƒˆçµæœ</h2>
            <div id="testResults"></div>
        </div>
        
        <div class="test-section">
            <h2>ğŸ¬ ã‚°ãƒªãƒ¼ãƒ†ã‚£ãƒ³ã‚°å®Ÿè¡Œãƒ†ã‚¹ãƒˆ</h2>
            <button class="btn" onclick="simulateGreeting()">ğŸŒ… æŒ¨æ‹¶ã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆ</button>
            <button class="btn" onclick="openSecretaryPanel()">ğŸ  ç§˜æ›¸ã®éƒ¨å±‹ã‚’é–‹ã</button>
            <button class="btn" onclick="resetTeam()">ğŸ”„ ãƒãƒ¼ãƒ ã‚’ãƒªã‚»ãƒƒãƒˆ</button>
            <div id="greetingDisplay"></div>
        </div>
        
        <div class="test-section">
            <h2>ğŸ’¾ ç¾åœ¨ã®çŠ¶æ…‹</h2>
            <div id="currentState"></div>
        </div>
    </div>

    <!-- å¿…è¦ãªJSãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã¿ -->
    <script src="js/secretary-team.js"></script>
    <script src="js/greeting-team-selector.js"></script>
    <script src="js/secretary-greetings.js"></script>
    <script src="js/secretary-panel.js"></script>

    <script>
        const testResults = document.getElementById('testResults');
        const greetingDisplay = document.getElementById('greetingDisplay');
        const currentState = document.getElementById('currentState');

        // ãƒ†ã‚¹ãƒˆçµæœã‚’è¡¨ç¤º
        function addTestResult(title, success, message) {
            const result = document.createElement('div');
            result.className = `test-result ${success ? 'success' : 'error'}`;
            result.innerHTML = `
                <div style="display: flex; align-items: center; gap: 0.5rem;">
                    <span style="font-size: 1.5rem;">${success ? 'âœ…' : 'âŒ'}</span>
                    <div style="flex: 1;">
                        <strong>${title}</strong>
                        <div style="color: #6b7280; margin-top: 0.25rem;">${message}</div>
                    </div>
                </div>
            `;
            testResults.appendChild(result);
        }

        // ç¾åœ¨ã®çŠ¶æ…‹ã‚’è¡¨ç¤º
        function updateCurrentState() {
            if (typeof GreetingTeamSelector === 'undefined') {
                currentState.innerHTML = '<p style="color: #ef4444;">âš ï¸ GreetingTeamSelector ãŒèª­ã¿è¾¼ã¾ã‚Œã¦ã„ã¾ã›ã‚“</p>';
                return;
            }

            const team = GreetingTeamSelector.getGreetingTeam();
            const teamSecretaries = GreetingTeamSelector.getGreetingTeamSecretaries();
            const stats = GreetingTeamSelector.getTeamStats();

            currentState.innerHTML = `
                <div style="display: grid; gap: 1rem;">
                    <div>
                        <strong>ã‚°ãƒªãƒ¼ãƒ†ã‚£ãƒ³ã‚°ãƒãƒ¼ãƒ  (${team.length}/3äºº):</strong>
                        <div style="margin-top: 0.5rem;">
                            ${team.length === 0 ? '<code>ãªã—</code>' : team.map(id => `<code>${id}</code>`).join(', ')}
                        </div>
                    </div>
                    <div>
                        <strong>ç§˜æ›¸æƒ…å ±:</strong>
                        <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); gap: 0.75rem; margin-top: 0.5rem;">
                            ${teamSecretaries.map(s => `
                                <div style="background: white; border: 2px solid #e5e7eb; border-radius: 0.5rem; padding: 0.75rem; text-align: center;">
                                    <div style="font-size: 2rem; margin-bottom: 0.25rem;">${s.avatar || 'ğŸ‘¤'}</div>
                                    <div style="font-weight: 600; font-size: 0.875rem;">${s.name}</div>
                                    <div style="font-size: 0.75rem; color: #6b7280;">${s.type || 'ç§˜æ›¸'}</div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                    <div>
                        <strong>çµ±è¨ˆæƒ…å ±:</strong>
                        <pre style="background: #f3f4f6; padding: 1rem; border-radius: 0.5rem; margin-top: 0.5rem; overflow-x: auto;">${JSON.stringify(stats, null, 2)}</pre>
                    </div>
                </div>
            `;
        }

        // æŒ¨æ‹¶ã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆ
        function simulateGreeting() {
            if (typeof GreetingTeamSelector === 'undefined') {
                alert('GreetingTeamSelector ãŒèª­ã¿è¾¼ã¾ã‚Œã¦ã„ã¾ã›ã‚“');
                return;
            }

            const teamSecretaries = GreetingTeamSelector.getGreetingTeamSecretaries();
            
            if (teamSecretaries.length === 0) {
                greetingDisplay.innerHTML = `
                    <div class="greeting-display" style="text-align: center;">
                        <div style="font-size: 3rem; margin-bottom: 1rem;">ğŸ˜´</div>
                        <p style="color: #6b7280;">ã¾ã ã‚°ãƒªãƒ¼ãƒ†ã‚£ãƒ³ã‚°ãƒãƒ¼ãƒ ãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“</p>
                    </div>
                `;
                return;
            }

            // ã‚°ãƒªãƒ¼ãƒ†ã‚£ãƒ³ã‚°è¡¨ç¤º
            greetingDisplay.innerHTML = '<h3 style="margin-bottom: 1rem; color: #1f2937;">ğŸŒ… èµ·å‹•æ™‚ã®æŒ¨æ‹¶</h3>';
            
            teamSecretaries.forEach((secretary, index) => {
                setTimeout(() => {
                    const greeting = SecretaryGreetings ? 
                        SecretaryGreetings.getStartupGreeting(secretary.id) : 
                        { message: 'é ‘å¼µã‚Šã¾ã—ã‚‡ã†!' };
                    
                    const div = document.createElement('div');
                    div.className = 'greeting-display';
                    div.innerHTML = `
                        <div class="secretary-avatar">${secretary.avatar || 'ğŸ‘¤'}</div>
                        <div class="secretary-name">${secretary.name}</div>
                        <div class="secretary-message">${greeting.message || 'é ‘å¼µã‚Šã¾ã—ã‚‡ã†!'}</div>
                    `;
                    div.style.animation = 'slideIn 0.5s ease';
                    greetingDisplay.appendChild(div);
                }, index * 1000);
            });
        }

        // ç§˜æ›¸ã®éƒ¨å±‹ã‚’é–‹ã
        function openSecretaryPanel() {
            if (typeof showSecretaryPanel === 'function') {
                showSecretaryPanel();
            } else {
                alert('ç§˜æ›¸ãƒ‘ãƒãƒ«ãŒèª­ã¿è¾¼ã¾ã‚Œã¦ã„ã¾ã›ã‚“');
            }
        }

        // ãƒãƒ¼ãƒ ã‚’ãƒªã‚»ãƒƒãƒˆ
        function resetTeam() {
            if (typeof GreetingTeamSelector === 'undefined') {
                alert('GreetingTeamSelector ãŒèª­ã¿è¾¼ã¾ã‚Œã¦ã„ã¾ã›ã‚“');
                return;
            }

            // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã«ãƒªã‚»ãƒƒãƒˆ
            GreetingTeamSelector.saveGreetingTeam(['sakura', 'reina', 'yui']);
            updateCurrentState();
            addTestResult('ãƒªã‚»ãƒƒãƒˆå®Œäº†', true, 'ã‚°ãƒªãƒ¼ãƒ†ã‚£ãƒ³ã‚°ãƒãƒ¼ãƒ ã‚’ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ(ã•ãã‚‰ã€ã‚Œã„ãªã€ã‚†ã„)ã«ãƒªã‚»ãƒƒãƒˆã—ã¾ã—ãŸ');
        }

        // ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
        function runTests() {
            console.log('ğŸ§ª ã‚°ãƒªãƒ¼ãƒ†ã‚£ãƒ³ã‚°ãƒãƒ¼ãƒ é¸æŠçµ±åˆãƒ†ã‚¹ãƒˆé–‹å§‹');

            // Test 1: SecretaryTeamåˆæœŸåŒ–ç¢ºèª
            if (typeof SecretaryTeam !== 'undefined') {
                const allSecretaries = SecretaryTeam.getAllSecretaries();
                addTestResult(
                    'Test 1: ç§˜æ›¸ã‚·ã‚¹ãƒ†ãƒ åˆæœŸåŒ–',
                    allSecretaries.length > 0,
                    `${allSecretaries.length}äººã®ç§˜æ›¸ãŒç™»éŒ²ã•ã‚Œã¦ã„ã¾ã™`
                );
            } else {
                addTestResult('Test 1: ç§˜æ›¸ã‚·ã‚¹ãƒ†ãƒ åˆæœŸåŒ–', false, 'SecretaryTeamãŒèª­ã¿è¾¼ã¾ã‚Œã¦ã„ã¾ã›ã‚“');
            }

            // Test 2: GreetingTeamSelectoråˆæœŸåŒ–ç¢ºèª
            if (typeof GreetingTeamSelector !== 'undefined') {
                addTestResult(
                    'Test 2: ã‚°ãƒªãƒ¼ãƒ†ã‚£ãƒ³ã‚°ãƒãƒ¼ãƒ é¸æŠã‚·ã‚¹ãƒ†ãƒ åˆæœŸåŒ–',
                    true,
                    'GreetingTeamSelectorãŒæ­£å¸¸ã«èª­ã¿è¾¼ã¾ã‚Œã¾ã—ãŸ'
                );

                // Test 3: ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒãƒ¼ãƒ ç¢ºèª
                const team = GreetingTeamSelector.getGreetingTeam();
                addTestResult(
                    'Test 3: ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚°ãƒªãƒ¼ãƒ†ã‚£ãƒ³ã‚°ãƒãƒ¼ãƒ ',
                    team.length === 3,
                    `ç¾åœ¨${team.length}äººãŒé¸æŠã•ã‚Œã¦ã„ã¾ã™: ${team.join(', ')}`
                );

                // Test 4: ãƒˆã‚°ãƒ«æ“ä½œãƒ†ã‚¹ãƒˆ
                const testId = 'mio';
                const beforeToggle = team.includes(testId);
                GreetingTeamSelector.toggleGreetingTeam(testId);
                const afterToggle = GreetingTeamSelector.getGreetingTeam().includes(testId);
                const toggleSuccess = beforeToggle !== afterToggle;
                
                addTestResult(
                    'Test 4: ãƒˆã‚°ãƒ«æ“ä½œ',
                    toggleSuccess,
                    `${testId}ã®é¸æŠçŠ¶æ…‹ãŒæ­£ã—ãåˆ‡ã‚Šæ›¿ã‚ã‚Šã¾ã—ãŸ (${beforeToggle} â†’ ${afterToggle})`
                );

                // å…ƒã«æˆ»ã™
                GreetingTeamSelector.toggleGreetingTeam(testId);

                // Test 5: æœ€å¤§3äººåˆ¶é™ãƒ†ã‚¹ãƒˆ
                const fullTeam = ['sakura', 'reina', 'yui'];
                GreetingTeamSelector.saveGreetingTeam(fullTeam);
                const addResult = GreetingTeamSelector.addToGreetingTeam('mio');
                addTestResult(
                    'Test 5: æœ€å¤§3äººåˆ¶é™',
                    addResult === false,
                    'æœ€å¤§3äººåˆ¶é™ãŒæ­£ã—ãæ©Ÿèƒ½ã—ã¦ã„ã¾ã™'
                );

                // Test 6: é¸æŠã•ã‚ŒãŸç§˜æ›¸ã®å–å¾—
                const teamSecretaries = GreetingTeamSelector.getGreetingTeamSecretaries();
                addTestResult(
                    'Test 6: ç§˜æ›¸æƒ…å ±å–å¾—',
                    teamSecretaries.length === fullTeam.length,
                    `${teamSecretaries.length}äººã®ç§˜æ›¸æƒ…å ±ã‚’æ­£å¸¸ã«å–å¾—ã—ã¾ã—ãŸ`
                );

            } else {
                addTestResult('Test 2: ã‚°ãƒªãƒ¼ãƒ†ã‚£ãƒ³ã‚°ãƒãƒ¼ãƒ é¸æŠã‚·ã‚¹ãƒ†ãƒ åˆæœŸåŒ–', false, 'GreetingTeamSelectorãŒèª­ã¿è¾¼ã¾ã‚Œã¦ã„ã¾ã›ã‚“');
            }

            // ç¾åœ¨ã®çŠ¶æ…‹ã‚’è¡¨ç¤º
            updateCurrentState();
        }

        // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã«ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
        window.addEventListener('DOMContentLoaded', () => {
            setTimeout(runTests, 500);
        });

        // ã‚¹ãƒ©ã‚¤ãƒ‰ã‚¤ãƒ³ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideIn {
                from {
                    opacity: 0;
                    transform: translateY(20px);
                }
                to {
                    opacity: 1;
                    transform: translateY(0);
                }
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>
