<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ã‚ªãƒ³ãƒœãƒ¼ãƒ‡ã‚£ãƒ³ã‚°æ”¹è‰¯ç‰ˆãƒ†ã‚¹ãƒˆ - ç§˜æ›¸ã®éƒ¨å±‹çµ±åˆ</title>
    <link rel="stylesheet" href="css/onboarding.css">
    <style>
        body {
            margin: 0;
            padding: 20px;
            font-family: 'Noto Sans JP', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .test-container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 16px;
            padding: 32px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }

        h1 {
            color: #1e293b;
            margin-bottom: 24px;
            font-size: 2rem;
        }

        .test-info {
            background: #f0f9ff;
            border-left: 4px solid #3b82f6;
            padding: 16px;
            border-radius: 8px;
            margin-bottom: 24px;
        }

        .test-info h2 {
            margin: 0 0 8px 0;
            color: #1e40af;
            font-size: 1.125rem;
        }

        .test-info p {
            margin: 4px 0;
            color: #334155;
            font-size: 0.875rem;
        }

        .button-group {
            display: flex;
            gap: 12px;
            margin-bottom: 24px;
        }

        .test-button {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }

        .test-button.primary {
            background: linear-gradient(135deg, #3b82f6, #8b5cf6);
            color: white;
        }

        .test-button.primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(59, 130, 246, 0.4);
        }

        .test-button.secondary {
            background: white;
            color: #64748b;
            border: 2px solid #e2e8f0;
        }

        .test-button.secondary:hover {
            border-color: #cbd5e1;
            background: #f8fafc;
        }

        .test-log {
            background: #1e293b;
            color: #e2e8f0;
            padding: 16px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 0.875rem;
            max-height: 300px;
            overflow-y: auto;
            margin-top: 24px;
        }

        .test-log-item {
            margin: 4px 0;
            padding: 4px 0;
            border-bottom: 1px solid #334155;
        }

        .test-log-item:last-child {
            border-bottom: none;
        }

        .success {
            color: #10b981;
        }

        .error {
            color: #ef4444;
        }

        .info {
            color: #3b82f6;
        }

        .mock-secretary-room {
            display: none;
            background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
            padding: 32px;
            border-radius: 12px;
            text-align: center;
            margin-top: 24px;
            border: 3px solid #fbbf24;
        }

        .mock-secretary-room.active {
            display: block;
            animation: slideUp 0.5s ease;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .mock-secretary-room h2 {
            color: #78350f;
            margin: 0 0 16px 0;
            font-size: 1.75rem;
        }

        .mock-secretary-room p {
            color: #92400e;
            margin: 8px 0;
            font-size: 1.125rem;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>ğŸ§ª ã‚ªãƒ³ãƒœãƒ¼ãƒ‡ã‚£ãƒ³ã‚°æ”¹è‰¯ç‰ˆãƒ†ã‚¹ãƒˆ</h1>
        
        <div class="test-info">
            <h2>ğŸ“‹ ãƒ†ã‚¹ãƒˆå†…å®¹</h2>
            <p><strong>å¤‰æ›´ç‚¹:</strong> Step 4ã€Œç§˜æ›¸é¸æŠã€â†’ã€Œç§˜æ›¸ã®éƒ¨å±‹ã¸ã®èª˜å°ã€</p>
            <p><strong>ç¢ºèªé …ç›®:</strong></p>
            <p>1. ğŸ¢ ç§˜æ›¸ã®éƒ¨å±‹ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼è¡¨ç¤ºï¼ˆ3é …ç›®ï¼‰</p>
            <p>2. ğŸ’¡ CTAãƒœãƒƒã‚¯ã‚¹è¡¨ç¤ºï¼ˆé»„è‰²èƒŒæ™¯ï¼‰</p>
            <p>3. ğŸš€ ã€Œç§˜æ›¸ã®éƒ¨å±‹ã¸ã€ãƒœã‚¿ãƒ³ã‚¯ãƒªãƒƒã‚¯ â†’ ç”»é¢é·ç§»</p>
            <p>4. ğŸ”„ ã€Œå¾Œã§é¸ã¶ã€ãƒœã‚¿ãƒ³ â†’ ãƒ›ãƒ¼ãƒ ç”»é¢ã¸</p>
        </div>

        <div class="button-group">
            <button class="test-button primary" onclick="testShowStep4()">
                Step 4ã‚’è¡¨ç¤º
            </button>
            <button class="test-button secondary" onclick="clearTest()">
                ãƒªã‚»ãƒƒãƒˆ
            </button>
        </div>

        <!-- ãƒ¢ãƒƒã‚¯ï¼šç§˜æ›¸ã®éƒ¨å±‹ -->
        <div id="mockSecretaryRoom" class="mock-secretary-room">
            <h2>ğŸ¢ ç§˜æ›¸ã®éƒ¨å±‹</h2>
            <p>âœ… ç”»é¢é·ç§»æˆåŠŸï¼</p>
            <p>å®Ÿéš›ã®ç§˜æ›¸ã®éƒ¨å±‹ç”»é¢ãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™</p>
            <button class="test-button secondary" onclick="closeMockRoom()">é–‰ã˜ã‚‹</button>
        </div>

        <!-- ãƒ†ã‚¹ãƒˆãƒ­ã‚° -->
        <div class="test-log" id="testLog">
            <div class="test-log-item info">ğŸ“ ãƒ†ã‚¹ãƒˆãƒ­ã‚°</div>
        </div>
    </div>

    <!-- ã‚ªãƒ³ãƒœãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚·ã‚¹ãƒ†ãƒ èª­ã¿è¾¼ã¿ -->
    <script src="js/toast-notification.js"></script>
    <script src="js/onboarding-system.js"></script>

    <script>
        // ãƒ†ã‚¹ãƒˆãƒ­ã‚°é–¢æ•°
        function log(message, type = 'info') {
            const logElement = document.getElementById('testLog');
            const logItem = document.createElement('div');
            logItem.className = `test-log-item ${type}`;
            logItem.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
            logElement.appendChild(logItem);
            logElement.scrollTop = logElement.scrollHeight;
            console.log(message);
        }

        // Step 4ã‚’è¡¨ç¤º
        function testShowStep4() {
            log('ğŸ”„ Step 4è¡¨ç¤ºãƒ†ã‚¹ãƒˆé–‹å§‹...', 'info');
            
            // localStorageã‚’ã‚¯ãƒªã‚¢ï¼ˆåˆå›è¨ªå•çŠ¶æ…‹ã«ã™ã‚‹ï¼‰
            localStorage.removeItem('toeic_onboarding_completed');
            log('âœ… localStorage ã‚¯ãƒªã‚¢å®Œäº†', 'success');
            
            // OnboardingSystemã®stateã‚’ãƒªã‚»ãƒƒãƒˆ
            if (window.OnboardingSystem) {
                OnboardingSystem.state.currentStep = 3; // Step 4ã®æ‰‹å‰
                OnboardingSystem.state.diagnosticAnswers = [
                    {questionId: 'diag_1', selectedOption: 'A', isCorrect: true},
                    {questionId: 'diag_2', selectedOption: 'A', isCorrect: true},
                    {questionId: 'diag_3', selectedOption: 'B', isCorrect: true}
                ];
                OnboardingSystem.state.userLevel = {
                    level: 'intermediate',
                    accuracy: 60,
                    correctCount: 3,
                    estimatedScore: '450-600',
                    recommendation: 'æ–‡æ³•ã®å¿œç”¨åŠ›ã‚’é›ãˆã¾ã—ã‚‡ã†ï¼'
                };
                log('âœ… OnboardingSystem state è¨­å®šå®Œäº†', 'success');
                
                // Step 4ã‚’è¡¨ç¤º
                OnboardingSystem.showSecretarySelection();
                log('âœ… Step 4ï¼ˆç§˜æ›¸ã®éƒ¨å±‹ã¸ã®èª˜å°ï¼‰è¡¨ç¤ºå®Œäº†', 'success');
                log('ğŸ“ ä»¥ä¸‹ã‚’ç¢ºèªã—ã¦ãã ã•ã„:', 'info');
                log('  1. ğŸ¢ ã‚¢ã‚¤ã‚³ãƒ³ã¨ã€Œç§˜æ›¸ã®éƒ¨å±‹ã¸ã‚ˆã†ã“ãï¼ã€ã‚¿ã‚¤ãƒˆãƒ«', 'info');
                log('  2. 3ã¤ã®ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼æ©Ÿèƒ½ï¼ˆğŸ‘¥ğŸ’¬ğŸï¼‰', 'info');
                log('  3. é»„è‰²ã®CTAãƒœãƒƒã‚¯ã‚¹ï¼ˆğŸ’¡ï¼‰', 'info');
                log('  4. ã€Œç§˜æ›¸ã®éƒ¨å±‹ã¸ ğŸš€ã€ãƒœã‚¿ãƒ³', 'info');
                log('  5. ã€Œå¾Œã§é¸ã¶ã€ãƒœã‚¿ãƒ³', 'info');
            } else {
                log('âŒ OnboardingSystem ãŒèª­ã¿è¾¼ã¾ã‚Œã¦ã„ã¾ã›ã‚“', 'error');
            }
        }

        // ãƒ¢ãƒƒã‚¯ï¼šç§˜æ›¸ã®éƒ¨å±‹ã‚’è¡¨ç¤ºã™ã‚‹é–¢æ•°ï¼ˆã‚°ãƒ­ãƒ¼ãƒãƒ«ã«å®šç¾©ï¼‰
        window.showSecretaryRoom = function() {
            log('ğŸ¢ showSecretaryRoom() å‘¼ã³å‡ºã—æˆåŠŸ', 'success');
            log('âœ… ç§˜æ›¸ã®éƒ¨å±‹ã¸ç”»é¢é·ç§»', 'success');
            
            // ãƒ¢ãƒƒã‚¯ç”»é¢ã‚’è¡¨ç¤º
            const mockRoom = document.getElementById('mockSecretaryRoom');
            mockRoom.classList.add('active');
            
            log('ğŸ“Š æœŸå¾…ã•ã‚Œã‚‹å‹•ä½œ:', 'info');
            log('  1. ã‚ªãƒ³ãƒœãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ç”»é¢ãŒãƒ•ã‚§ãƒ¼ãƒ‰ã‚¢ã‚¦ãƒˆ', 'info');
            log('  2. ç§˜æ›¸ã®éƒ¨å±‹ç”»é¢ãŒè¡¨ç¤ºã•ã‚Œã‚‹', 'info');
            log('  3. ãƒˆãƒ¼ã‚¹ãƒˆé€šçŸ¥ãŒè¡¨ç¤ºã•ã‚Œã‚‹', 'info');
        };

        // ãƒ¢ãƒƒã‚¯ç”»é¢ã‚’é–‰ã˜ã‚‹
        function closeMockRoom() {
            const mockRoom = document.getElementById('mockSecretaryRoom');
            mockRoom.classList.remove('active');
            log('ğŸ”„ ãƒ¢ãƒƒã‚¯ç§˜æ›¸ã®éƒ¨å±‹ã‚’é–‰ã˜ã¾ã—ãŸ', 'info');
        }

        // ãƒ†ã‚¹ãƒˆã‚’ãƒªã‚»ãƒƒãƒˆ
        function clearTest() {
            // ã‚ªãƒ³ãƒœãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ç”»é¢ã‚’å‰Šé™¤
            const overlay = document.getElementById('onboardingOverlay');
            if (overlay) {
                overlay.remove();
                log('ğŸ—‘ï¸ ã‚ªãƒ³ãƒœãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ç”»é¢ã‚’å‰Šé™¤', 'info');
            }
            
            // ãƒ¢ãƒƒã‚¯ç”»é¢ã‚’éè¡¨ç¤º
            closeMockRoom();
            
            // ãƒ­ã‚°ã‚’ã‚¯ãƒªã‚¢
            const logElement = document.getElementById('testLog');
            logElement.innerHTML = '<div class="test-log-item info">ğŸ“ ãƒ†ã‚¹ãƒˆãƒ­ã‚°ï¼ˆãƒªã‚»ãƒƒãƒˆæ¸ˆã¿ï¼‰</div>';
            
            log('âœ… ãƒ†ã‚¹ãƒˆã‚’ãƒªã‚»ãƒƒãƒˆã—ã¾ã—ãŸ', 'success');
        }

        // åˆæœŸåŒ–ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
        window.addEventListener('DOMContentLoaded', () => {
            log('âœ… ãƒ†ã‚¹ãƒˆãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿å®Œäº†', 'success');
            log('ğŸ“ ã€ŒStep 4ã‚’è¡¨ç¤ºã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ãƒ†ã‚¹ãƒˆã‚’é–‹å§‹ã—ã¦ãã ã•ã„', 'info');
        });

        // OnboardingSystem.goToSecretaryRoom()ã®ãƒ­ã‚°ç›£è¦–
        if (window.OnboardingSystem) {
            const originalGoToSecretaryRoom = OnboardingSystem.goToSecretaryRoom;
            OnboardingSystem.goToSecretaryRoom = function() {
                log('ğŸ–±ï¸ ã€Œç§˜æ›¸ã®éƒ¨å±‹ã¸ã€ãƒœã‚¿ãƒ³ãŒã‚¯ãƒªãƒƒã‚¯ã•ã‚Œã¾ã—ãŸ', 'info');
                log('ğŸ”„ goToSecretaryRoom() å®Ÿè¡Œä¸­...', 'info');
                
                // ã‚ªãƒªã‚¸ãƒŠãƒ«é–¢æ•°ã‚’å®Ÿè¡Œ
                originalGoToSecretaryRoom.call(this);
            };

            const originalSkipSecretarySelection = OnboardingSystem.skipSecretarySelection;
            OnboardingSystem.skipSecretarySelection = function() {
                log('ğŸ–±ï¸ ã€Œå¾Œã§é¸ã¶ã€ãƒœã‚¿ãƒ³ãŒã‚¯ãƒªãƒƒã‚¯ã•ã‚Œã¾ã—ãŸ', 'info');
                log('ğŸ”„ skipSecretarySelection() å®Ÿè¡Œä¸­...', 'info');
                log('âœ… ãƒ›ãƒ¼ãƒ ç”»é¢ã¸é·ç§»ï¼ˆå®Œäº†ï¼‰', 'success');
                
                // ã‚ªãƒªã‚¸ãƒŠãƒ«é–¢æ•°ã‚’å®Ÿè¡Œ
                originalSkipSecretarySelection.call(this);
            };
        }
    </script>
</body>
</html>
