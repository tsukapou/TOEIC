<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ã‚°ãƒªãƒ¼ãƒ†ã‚£ãƒ³ã‚°é¸æŠãƒ‡ãƒãƒƒã‚°</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            padding: 2rem;
            background: #f3f4f6;
        }
        .debug-panel {
            background: white;
            border-radius: 0.75rem;
            padding: 1.5rem;
            margin-bottom: 1rem;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        .debug-panel h3 {
            margin: 0 0 1rem 0;
            color: #1f2937;
        }
        pre {
            background: #f3f4f6;
            padding: 1rem;
            border-radius: 0.5rem;
            overflow-x: auto;
        }
        button {
            padding: 0.75rem 1.5rem;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 0.5rem;
            font-weight: 600;
            cursor: pointer;
            margin: 0.5rem;
        }
        button:hover {
            background: #5568d3;
        }
    </style>
</head>
<body>
    <h1>ğŸ› ã‚°ãƒªãƒ¼ãƒ†ã‚£ãƒ³ã‚°é¸æŠãƒ‡ãƒãƒƒã‚°</h1>
    
    <div class="debug-panel">
        <h3>ğŸ“‹ LocalStorage ã®çŠ¶æ…‹</h3>
        <button onclick="checkLocalStorage()">LocalStorageã‚’ç¢ºèª</button>
        <button onclick="clearGreetingTeam()">ã‚°ãƒªãƒ¼ãƒ†ã‚£ãƒ³ã‚°ãƒãƒ¼ãƒ ã‚’ã‚¯ãƒªã‚¢</button>
        <button onclick="resetToDefault()">ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã«æˆ»ã™</button>
        <pre id="localStorageData"></pre>
    </div>
    
    <div class="debug-panel">
        <h3>ğŸ‘¥ è§£é™¤æ¸ˆã¿ç§˜æ›¸</h3>
        <pre id="unlockedSecretaries"></pre>
    </div>
    
    <div class="debug-panel">
        <h3>ğŸŒ… ç¾åœ¨ã®ã‚°ãƒªãƒ¼ãƒ†ã‚£ãƒ³ã‚°ãƒãƒ¼ãƒ </h3>
        <pre id="currentTeam"></pre>
    </div>
    
    <div class="debug-panel">
        <h3>ğŸ¯ é¸æŠçŠ¶æ…‹ãƒã‚§ãƒƒã‚¯</h3>
        <pre id="selectionStatus"></pre>
    </div>
    
    <div class="debug-panel">
        <h3>ğŸ§ª ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ</h3>
        <button onclick="testToggle('sakura')">ã•ãã‚‰ã‚’ãƒˆã‚°ãƒ«</button>
        <button onclick="testToggle('reina')">ãƒ¬ã‚¤ãƒŠã‚’ãƒˆã‚°ãƒ«</button>
        <button onclick="testToggle('rio')">ã‚ŠãŠã‚’ãƒˆã‚°ãƒ«</button>
        <pre id="testResults"></pre>
    </div>
    
    <div class="debug-panel">
        <h3>ğŸ  ç§˜æ›¸ãƒ‘ãƒãƒ«ãƒ†ã‚¹ãƒˆ</h3>
        <button onclick="showSecretaryPanel()">ç§˜æ›¸ã®éƒ¨å±‹ã‚’é–‹ã</button>
    </div>

    <script src="js/secretary-team.js"></script>
    <script src="js/greeting-team-selector.js"></script>
    <script src="js/secretary-panel.js"></script>
    
    <script>
        function checkLocalStorage() {
            const data = {
                greetingTeam: localStorage.getItem('greetingTeamMembers'),
                unlockedSecretaries: localStorage.getItem('toeic_unlocked_secretaries')
            };
            
            document.getElementById('localStorageData').textContent = JSON.stringify(data, null, 2);
            console.log('ğŸ“¦ LocalStorage:', data);
        }
        
        function clearGreetingTeam() {
            localStorage.removeItem('greetingTeamMembers');
            console.log('ğŸ—‘ï¸ ã‚°ãƒªãƒ¼ãƒ†ã‚£ãƒ³ã‚°ãƒãƒ¼ãƒ ã‚’ã‚¯ãƒªã‚¢ã—ã¾ã—ãŸ');
            checkLocalStorage();
            updateAll();
        }
        
        function resetToDefault() {
            if (typeof GreetingTeamSelector !== 'undefined') {
                GreetingTeamSelector.saveGreetingTeam(['sakura', 'reina', 'rio']);
                console.log('ğŸ”„ ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ(sakura, reina, rio)ã«æˆ»ã—ã¾ã—ãŸ');
                checkLocalStorage();
                updateAll();
            }
        }
        
        function updateAll() {
            // è§£é™¤æ¸ˆã¿ç§˜æ›¸
            if (typeof SecretaryTeam !== 'undefined') {
                const unlocked = SecretaryTeam.getUnlockedSecretaries();
                document.getElementById('unlockedSecretaries').textContent = 
                    JSON.stringify(unlocked, null, 2);
                console.log('ğŸ‘¥ è§£é™¤æ¸ˆã¿ç§˜æ›¸:', unlocked);
            }
            
            // ç¾åœ¨ã®ãƒãƒ¼ãƒ 
            if (typeof GreetingTeamSelector !== 'undefined') {
                const team = GreetingTeamSelector.getGreetingTeam();
                document.getElementById('currentTeam').textContent = 
                    JSON.stringify(team, null, 2) + `\n\näººæ•°: ${team.length}äºº`;
                console.log('ğŸŒ… ç¾åœ¨ã®ãƒãƒ¼ãƒ :', team);
                
                // é¸æŠçŠ¶æ…‹ãƒã‚§ãƒƒã‚¯
                if (typeof SecretaryTeam !== 'undefined') {
                    const unlocked = SecretaryTeam.getUnlockedSecretaries();
                    const status = unlocked.map(id => {
                        const isSelected = team.includes(id);
                        return {
                            id: id,
                            name: SecretaryTeam.secretaries[id]?.name || id,
                            selected: isSelected
                        };
                    });
                    document.getElementById('selectionStatus').textContent = 
                        JSON.stringify(status, null, 2);
                    console.log('ğŸ¯ é¸æŠçŠ¶æ…‹:', status);
                }
            }
        }
        
        function testToggle(secretaryId) {
            if (typeof GreetingTeamSelector === 'undefined') {
                alert('GreetingTeamSelector ãŒèª­ã¿è¾¼ã¾ã‚Œã¦ã„ã¾ã›ã‚“');
                return;
            }
            
            console.log(`ğŸ§ª ${secretaryId} ã‚’ãƒˆã‚°ãƒ«ã—ã¾ã™...`);
            const result = GreetingTeamSelector.toggleGreetingTeam(secretaryId);
            
            const resultText = document.getElementById('testResults');
            resultText.textContent += `\n[${new Date().toLocaleTimeString()}] ${secretaryId} ã‚’ãƒˆã‚°ãƒ«: ${result === null ? 'æœ€å¤§äººæ•°ã«é”ã—ã¦ã„ã¾ã™' : result ? 'è¿½åŠ ' : 'å‰Šé™¤'}`;
            
            updateAll();
        }
        
        // åˆæœŸåŒ–
        window.addEventListener('DOMContentLoaded', () => {
            setTimeout(() => {
                console.log('ğŸš€ ãƒ‡ãƒãƒƒã‚°ãƒ„ãƒ¼ãƒ«åˆæœŸåŒ–');
                checkLocalStorage();
                updateAll();
                
                // è‡ªå‹•çš„ã«ç§˜æ›¸ãƒ‘ãƒãƒ«ã‚’é–‹ã
                setTimeout(() => {
                    if (typeof showSecretaryPanel === 'function') {
                        console.log('ğŸ  ç§˜æ›¸ãƒ‘ãƒãƒ«ã‚’è‡ªå‹•ã‚ªãƒ¼ãƒ—ãƒ³');
                        showSecretaryPanel();
                        
                        // æŒ¨æ‹¶æ‹…å½“ã‚¿ãƒ–ã‚’é–‹ã
                        setTimeout(() => {
                            if (typeof showSecretaryPanelTab === 'function') {
                                console.log('ğŸŒ… æŒ¨æ‹¶æ‹…å½“ã‚¿ãƒ–ã‚’è‡ªå‹•ã‚ªãƒ¼ãƒ—ãƒ³');
                                showSecretaryPanelTab('greeting');
                            }
                        }, 1000);
                    }
                }, 1000);
            }, 500);
        });
    </script>
</body>
</html>
